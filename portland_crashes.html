<!DOCTYPE html>
<html>
<head>
    <title>Portland Cyclist and Pedestrian Crashes</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
     integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
     crossorigin=""/>

    <!-- Make sure you put this AFTER Leaflet's CSS -->

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
     integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
     crossorigin=""></script>

    <style>
        #mapid { height: 100vh; }
    </style>
</head>
<body>

<div id="mapid"></div>

<script>
    // 1. Initialize the map
    const map = L.map('mapid').setView([43.65734974239763, -70.26189624400604], 15);

    // Add a tile layer (OpenStreetMap)
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: 'Â© [OpenStreetMap]() contributors'
    }).addTo(map);

    // 2. Fetch the remote data
    // Replace 'your_remote_data_source.geojson' with your actual API endpoint or GeoJSON file URL
    fetch('Crashes_10_Years.geojson')
        .then(response => response.json())
        .then(data => {  // 1( 2{
            // 3. Process and add markers using L.geoJSON
            L.geoJSON(data, { // 3( 4{
                onEachFeature: function (feature, layer) { // 5{
                    layer.bindPopup( // 6(
                        feature.properties["MDOT ID"] +
                        " : " +
                        feature.properties["Crash Date"]
                    ); // 5{
                } // 4{
                style: function (feature) { // 3
                    if (feature.properties["K - Fatalities Count"] > 0) { // 4
                        return { // 5
                            fillColor: 'red' // red if fatality
                        };  // 4
                    } // 3
                    else { // 4
                        return { // 5
                            fillColor: 'blue' // blue if not
                        };  // 4
                    }; // 3
                } // 2
            }).addTo(map);

            // Optional: Fit map bounds to the new markers (if using a layer group/feature group)
            // map.fitBounds(markersLayer.getBounds());
        })
        .catch(error => {
            console.error('Error fetching data:', error);
        });
</script>

</body>
</html>
